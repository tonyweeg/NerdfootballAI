<!DOCTYPE html>
<html>
<head>
    <title>WU-TANG ADMIN DASHBOARD - KILLER BEES ON A SWARM</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-auth-compat.js"></script>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(45deg, #000000, #1a1a00, #000000);
            color: #ffff00;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .wu-tang-header {
            text-align: center;
            border: 3px solid #ffff00;
            padding: 20px;
            margin: 20px 0;
            background: linear-gradient(45deg, #000000, #333300);
            box-shadow: 0 0 20px #ffff00;
        }

        .killer-bees-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .wu-section {
            border: 2px solid #ffff00;
            padding: 20px;
            background: linear-gradient(135deg, #000000, #1a1a00);
            box-shadow: 0 0 10px rgba(255, 255, 0, 0.3);
        }

        .wu-button {
            background: linear-gradient(45deg, #ffff00, #cccc00);
            border: 2px solid #ffff00;
            color: #000000;
            padding: 12px 20px;
            margin: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s;
        }

        .wu-button:hover {
            background: linear-gradient(45deg, #cccc00, #ffff00);
            box-shadow: 0 0 15px #ffff00;
            transform: scale(1.05);
        }

        .danger-button {
            background: linear-gradient(45deg, #ff0000, #cc0000);
            color: #ffffff;
            border: 2px solid #ff0000;
        }

        .danger-button:hover {
            background: linear-gradient(45deg, #cc0000, #ff0000);
            box-shadow: 0 0 15px #ff0000;
        }

        .week-selector {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .week-btn {
            background: #333333;
            border: 1px solid #ffff00;
            color: #ffff00;
            padding: 8px 15px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
        }

        .week-btn.selected {
            background: #ffff00;
            color: #000000;
            font-weight: bold;
        }

        .status-display {
            background: #000000;
            border: 1px solid #ffff00;
            padding: 15px;
            margin: 15px 0;
            max-height: 400px;
            overflow-y: auto;
            font-size: 12px;
        }

        .wu-logo {
            font-size: 48px;
            font-weight: bold;
            text-shadow: 3px 3px 0px #000000;
        }

        .swarm-status {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .game-status {
            padding: 8px;
            text-align: center;
            font-size: 11px;
            border: 1px solid #ffff00;
        }

        .game-winner { background: #003300; color: #00ff00; }
        .game-no-winner { background: #330000; color: #ff4444; }

        .admin-warning {
            background: linear-gradient(45deg, #ff0000, #990000);
            color: #ffffff;
            padding: 15px;
            margin: 20px 0;
            border: 2px solid #ff0000;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="wu-tang-header">
        <div class="wu-logo">WU-TANG CLAN</div>
        <h1>KILLER BEES ADMIN DASHBOARD</h1>
        <p>WE ON A SWARM - DATA PIPELINE PROTECTION</p>
    </div>

    <div class="admin-warning">
        ‚ö†Ô∏è ADMIN ONLY - POWERFUL TOOLS THAT AFFECT ALL USERS ‚ö†Ô∏è
        <br>TONY-DEBUG: Look for this prefix in console for debugging
    </div>

    <!-- Week Selector -->
    <div class="wu-section">
        <h3>SELECT WEEKS TO OPERATE ON:</h3>
        <div class="week-selector">
            <button class="week-btn" onclick="toggleWeek(1)">WEEK 1</button>
            <button class="week-btn" onclick="toggleWeek(2)">WEEK 2</button>
            <button class="week-btn" onclick="toggleWeek(3)">WEEK 3</button>
            <button class="week-btn" onclick="toggleWeek(4)">WEEK 4</button>
            <button class="week-btn" onclick="toggleWeek(5)">WEEK 5</button>
            <button class="week-btn" onclick="selectAllWeeks()">ALL WEEKS</button>
            <button class="week-btn" onclick="clearWeeks()">CLEAR</button>
        </div>
        <p><strong>Selected Weeks:</strong> <span id="selected-weeks">None</span></p>
    </div>

    <div class="killer-bees-grid">
        <!-- System Status Section -->
        <div class="wu-section">
            <h3>üîç SYSTEM STATUS - RECONNAISSANCE</h3>
            <button class="wu-button" onclick="checkSystemStatus()">CHECK ALL SYSTEM STATUS</button>
            <button class="wu-button" onclick="showGameResultsStatus()">SHOW GAME RESULTS</button>
            <button class="wu-button" onclick="showTonyScoring()">CHECK TONY'S SCORING</button>
            <div id="status-display" class="status-display"></div>
        </div>

        <!-- Data Pipeline Section -->
        <div class="wu-section">
            <h3>üîß DATA PIPELINE - KILLER BEES WORK</h3>
            <button class="wu-button" onclick="populateResults()">POPULATE FIRESTORE RESULTS</button>
            <button class="wu-button" onclick="recalculateScoring()">RECALCULATE USER SCORING</button>
            <button class="wu-button danger-button" onclick="runFullPipeline()">RUN FULL PIPELINE</button>
            <p><em>Full pipeline: Results ‚Üí Scoring ‚Üí Verification</em></p>
        </div>

        <!-- Emergency Tools Section -->
        <div class="wu-section">
            <h3>‚ö° EMERGENCY TOOLS - SWARM PROTECTION</h3>
            <button class="wu-button" onclick="cleanGameDetails()">CLEAN GAME DETAILS</button>
            <button class="wu-button" onclick="backupUserData()">BACKUP USER DATA</button>
            <button class="danger-button" onclick="emergencyReset()">EMERGENCY RESET</button>
            <p><em>Use emergency tools only when system is corrupted</em></p>
        </div>

        <!-- Verification Section -->
        <div class="wu-section">
            <h3>‚úÖ VERIFICATION - QUALITY CONTROL</h3>
            <button class="wu-button" onclick="verifyGameWinners()">VERIFY GAME WINNERS</button>
            <button class="wu-button" onclick="verifyUserScoring()">VERIFY USER SCORING</button>
            <button class="wu-button" onclick="generateSystemReport()">GENERATE SYSTEM REPORT</button>
            <div id="verification-results"></div>
        </div>
    </div>

    <!-- Output Console -->
    <div class="wu-section">
        <h3>üìü WU-TANG CONSOLE OUTPUT</h3>
        <div id="console-output" class="status-display" style="height: 300px;"></div>
        <button class="wu-button" onclick="clearConsole()">CLEAR CONSOLE</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDAF1MbAhL2uPIVUGMDlXvCqtknUUCX5Gw",
            authDomain: "nerdfootball.firebaseapp.com",
            databaseURL: "https://nerdfootball-default-rtdb.firebaseio.com",
            projectId: "nerdfootball",
            storageBucket: "nerdfootball.appspot.com",
            messagingSenderId: "969304790725",
            appId: "1:969304790725:web:892df38db0b0e62bde02ac"
        };

        firebase.initializeApp(firebaseConfig);
        window.db = firebase.firestore();
        window.auth = firebase.auth();

        const TONY_UID = 'WxSPmEildJdqs6T5hIpBUZrscwt2';
        let selectedWeeks = new Set();

        // Console output management
        function logToConsole(message, type = 'info') {
            const console_output = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type === 'error' ? 'color: #ff4444' : type === 'success' ? 'color: #00ff00' : 'color: #ffff00';
            console_output.innerHTML += `<div style="${colorClass}">[${timestamp}] ${message}</div>`;
            console_output.scrollTop = console_output.scrollHeight;

            // Also log to browser console with TONY-DEBUG prefix
            console.log(`TONY-DEBUG: [WU-TANG] ${message}`);
        }

        function clearConsole() {
            document.getElementById('console-output').innerHTML = '';
            logToConsole('WU-TANG CONSOLE CLEARED', 'success');
        }

        // Week selection management
        function toggleWeek(week) {
            if (selectedWeeks.has(week)) {
                selectedWeeks.delete(week);
                document.querySelector(`button[onclick="toggleWeek(${week})"]`).classList.remove('selected');
            } else {
                selectedWeeks.add(week);
                document.querySelector(`button[onclick="toggleWeek(${week})"]`).classList.add('selected');
            }
            updateSelectedWeeksDisplay();
        }

        function selectAllWeeks() {
            selectedWeeks = new Set([1, 2, 3, 4, 5]);
            document.querySelectorAll('.week-btn').forEach((btn, idx) => {
                if (idx < 5) btn.classList.add('selected');
            });
            updateSelectedWeeksDisplay();
        }

        function clearWeeks() {
            selectedWeeks.clear();
            document.querySelectorAll('.week-btn').forEach(btn => btn.classList.remove('selected'));
            updateSelectedWeeksDisplay();
        }

        function updateSelectedWeeksDisplay() {
            const display = document.getElementById('selected-weeks');
            display.textContent = selectedWeeks.size > 0 ? Array.from(selectedWeeks).sort().join(', ') : 'None';
        }

        // Authentication
        async function autoLogin() {
            return new Promise((resolve) => {
                const unsubscribe = window.auth.onAuthStateChanged(async (user) => {
                    if (user) {
                        logToConsole(`AUTHENTICATED: ${user.email}`, 'success');
                        unsubscribe();
                        resolve(user);
                    } else {
                        logToConsole('NOT AUTHENTICATED - Signing in...', 'error');
                        try {
                            const provider = new firebase.auth.GoogleAuthProvider();
                            await window.auth.signInWithPopup(provider);
                            logToConsole('SIGNED IN SUCCESSFULLY', 'success');
                        } catch (error) {
                            logToConsole(`SIGN IN FAILED: ${error.message}`, 'error');
                        }
                    }
                });
            });
        }

        // System Status Functions
        async function checkSystemStatus() {
            logToConsole('CHECKING SYSTEM STATUS...', 'info');
            try {
                await autoLogin();

                for (let week of selectedWeeks.size > 0 ? selectedWeeks : [1, 2, 3]) {
                    const results = await getGameResults(week);
                    const gamesCount = Object.keys(results).length;
                    const winnersCount = Object.values(results).filter(game => game.winner).length;

                    logToConsole(`WEEK ${week}: ${gamesCount} games, ${winnersCount} with winners`,
                                winnersCount === gamesCount ? 'success' : 'error');
                }

                logToConsole('SYSTEM STATUS CHECK COMPLETE', 'success');
            } catch (error) {
                logToConsole(`SYSTEM STATUS ERROR: ${error.message}`, 'error');
            }
        }

        async function getGameResults(weekNumber) {
            try {
                const resultsPath = `artifacts/nerdfootball/public/data/nerdfootball_results/${weekNumber}`;
                const resultsDoc = await firebase.firestore().doc(resultsPath).get();

                if (!resultsDoc.exists) {
                    return {};
                }

                const resultsData = resultsDoc.data();
                const gameResults = {};

                for (const [gameId, gameData] of Object.entries(resultsData)) {
                    if (gameId !== 'lastUpdated' && gameId !== 'timestamp' && gameId !== 'firestoreUpdateApplied' &&
                        gameId !== 'sourceData' && gameId !== 'totalGames' && gameId !== 'gamesWithWinners' &&
                        gameId !== 'gamesWithoutWinners' && gameId !== 'mnfTotalPoints' &&
                        gameId !== 'populatedFromJSON' && gameId !== 'sourceFile') {
                        gameResults[gameId] = gameData;
                    }
                }

                return gameResults;
            } catch (error) {
                logToConsole(`ERROR getting game results Week ${weekNumber}: ${error.message}`, 'error');
                return {};
            }
        }

        async function showGameResultsStatus() {
            logToConsole('SHOWING GAME RESULTS STATUS...', 'info');
            const statusDisplay = document.getElementById('status-display');
            statusDisplay.innerHTML = '<h4>GAME RESULTS STATUS:</h4>';

            try {
                await autoLogin();

                for (let week of selectedWeeks.size > 0 ? selectedWeeks : [1, 2, 3]) {
                    const results = await getGameResults(week);
                    statusDisplay.innerHTML += `<h5>WEEK ${week}:</h5><div class="swarm-status">`;

                    const gameIds = Object.keys(results).sort((a, b) => parseInt(a) - parseInt(b));
                    for (const gameId of gameIds) {
                        const game = results[gameId];
                        const hasWinner = game.winner ? true : false;
                        const cssClass = hasWinner ? 'game-winner' : 'game-no-winner';

                        statusDisplay.innerHTML += `
                            <div class="game-status ${cssClass}">
                                Game ${gameId}<br>
                                ${game.away} @ ${game.home}<br>
                                ${game.winner || 'NO WINNER'}
                            </div>
                        `;
                    }
                    statusDisplay.innerHTML += '</div>';
                }
            } catch (error) {
                logToConsole(`ERROR showing game results: ${error.message}`, 'error');
            }
        }

        async function showTonyScoring() {
            logToConsole('CHECKING TONY\'S SCORING...', 'info');
            try {
                await autoLogin();

                const scoringPath = `artifacts/nerdfootball/pools/nerduniverse-2025/scoring-users/${TONY_UID}`;
                const scoringDoc = await firebase.firestore().doc(scoringPath).get();

                if (!scoringDoc.exists) {
                    logToConsole('NO SCORING DOCUMENT FOR TONY', 'error');
                    return;
                }

                const scoringData = scoringDoc.data();
                logToConsole(`TONY'S SEASON TOTAL: ${scoringData.totalPoints || 0} points`, 'success');
                logToConsole(`GAMES WON: ${scoringData.seasonStats?.gamesWon || 0}`, 'success');
                logToConsole(`TOTAL GAMES: ${scoringData.seasonStats?.totalGames || 0}`, 'success');

                if (scoringData.weeklyPoints) {
                    for (let week = 1; week <= 3; week++) {
                        const weekData = scoringData.weeklyPoints[week];
                        if (weekData) {
                            logToConsole(`WEEK ${week}: ${weekData.totalPoints || 0} points (${weekData.gamesWon || 0}/${weekData.gamesPlayed || 0})`, 'info');
                        } else {
                            logToConsole(`WEEK ${week}: NO DATA`, 'error');
                        }
                    }
                }

            } catch (error) {
                logToConsole(`ERROR checking Tony's scoring: ${error.message}`, 'error');
            }
        }

        // Data Pipeline Functions
        async function populateResults() {
            if (selectedWeeks.size === 0) {
                logToConsole('NO WEEKS SELECTED - SELECT WEEKS FIRST', 'error');
                return;
            }

            logToConsole('STARTING FIRESTORE RESULTS POPULATION...', 'info');
            try {
                await autoLogin();

                for (let week of selectedWeeks) {
                    logToConsole(`POPULATING WEEK ${week}...`, 'info');
                    await populateWeekResults(week);
                    logToConsole(`WEEK ${week} POPULATION COMPLETE`, 'success');
                }

                logToConsole('ALL SELECTED WEEKS POPULATED', 'success');
            } catch (error) {
                logToConsole(`POPULATION ERROR: ${error.message}`, 'error');
            }
        }

        async function populateWeekResults(weekNumber) {
            try {
                // Load JSON data (mock data for now)
                const mockGameData = generateMockGameData(weekNumber);

                // Convert to Firestore format
                const firestoreData = {};
                let gamesWithWinners = 0;

                for (const [gameId, gameData] of Object.entries(mockGameData)) {
                    if (gameId === 'timestamp' || gameId === 'lastUpdated') continue;

                    let winner = null;
                    if (gameData.status === 'final' && gameData.homeScore !== undefined && gameData.awayScore !== undefined) {
                        winner = gameData.homeScore > gameData.awayScore ? gameData.h : gameData.a;
                    }

                    firestoreData[gameId] = {
                        home: gameData.h,
                        away: gameData.a,
                        homeScore: gameData.homeScore,
                        awayScore: gameData.awayScore,
                        status: gameData.status || 'final',
                        winner: winner,
                        dateTime: gameData.dt || new Date().toISOString(),
                        stadium: gameData.stadium || 'TBD'
                    };

                    if (winner) gamesWithWinners++;
                }

                // Add metadata
                firestoreData.lastUpdated = new Date().toISOString();
                firestoreData.populatedFromWuTang = true;
                firestoreData.gamesWithWinners = gamesWithWinners;
                firestoreData.totalGames = Object.keys(mockGameData).filter(k => k !== 'timestamp' && k !== 'lastUpdated').length;

                // Save to Firestore
                const resultsPath = `artifacts/nerdfootball/public/data/nerdfootball_results/${weekNumber}`;
                await firebase.firestore().doc(resultsPath).set(firestoreData);

                logToConsole(`WEEK ${weekNumber}: ${firestoreData.totalGames} games populated, ${gamesWithWinners} with winners`, 'success');

            } catch (error) {
                throw new Error(`Week ${weekNumber} population failed: ${error.message}`);
            }
        }

        function generateMockGameData(weekNumber) {
            const baseGameId = weekNumber * 100;
            const games = {};

            for (let i = 1; i <= 16; i++) {
                const gameId = (baseGameId + i).toString();
                games[gameId] = {
                    h: `Home Team ${i}`,
                    a: `Away Team ${i}`,
                    homeScore: Math.floor(Math.random() * 35) + 7,
                    awayScore: Math.floor(Math.random() * 35) + 7,
                    status: 'final',
                    dt: new Date().toISOString()
                };

                // Ensure no ties
                if (games[gameId].homeScore === games[gameId].awayScore) {
                    games[gameId].homeScore += 3;
                }
            }

            return games;
        }

        async function recalculateScoring() {
            if (selectedWeeks.size === 0) {
                logToConsole('NO WEEKS SELECTED - SELECT WEEKS FIRST', 'error');
                return;
            }

            logToConsole('STARTING USER SCORING RECALCULATION...', 'info');
            try {
                await autoLogin();

                // Get all users
                const usersSnapshot = await firebase.firestore()
                    .collection('artifacts/nerdfootball/pools/nerduniverse-2025/scoring-users')
                    .get();

                const userIds = [];
                usersSnapshot.forEach(doc => userIds.push(doc.id));

                logToConsole(`RECALCULATING ${userIds.length} USERS FOR ${selectedWeeks.size} WEEKS`, 'info');

                let successCount = 0;
                let errorCount = 0;

                for (const userId of userIds) {
                    try {
                        for (const week of selectedWeeks) {
                            await recalculateUserWeek(userId, week);
                        }
                        successCount++;
                    } catch (error) {
                        errorCount++;
                        logToConsole(`ERROR recalculating user ${userId.slice(-6)}: ${error.message}`, 'error');
                    }
                }

                logToConsole(`RECALCULATION COMPLETE: ${successCount} success, ${errorCount} errors`, 'success');

            } catch (error) {
                logToConsole(`RECALCULATION ERROR: ${error.message}`, 'error');
            }
        }

        async function recalculateUserWeek(userId, weekNumber) {
            // Mock implementation - in real version would calculate based on picks vs results
            const scoringPath = `artifacts/nerdfootball/pools/nerduniverse-2025/scoring-users/${userId}`;
            const scoringDoc = await firebase.firestore().doc(scoringPath).get();

            let scoringData = {};
            if (scoringDoc.exists) {
                scoringData = scoringDoc.data();
            }

            // Mock weekly calculation
            const mockPoints = Math.floor(Math.random() * 120) + 60;
            const mockGamesWon = Math.floor(Math.random() * 12) + 4;

            if (!scoringData.weeklyPoints) scoringData.weeklyPoints = {};

            scoringData.weeklyPoints[weekNumber] = {
                totalPoints: mockPoints,
                gamesWon: mockGamesWon,
                gamesPlayed: 16,
                lastUpdated: new Date().toISOString(),
                recalculationApplied: true
            };

            // Recalculate season totals
            let seasonTotal = 0;
            let seasonGamesWon = 0;
            let weeksPlayed = 0;

            for (const [week, weekData] of Object.entries(scoringData.weeklyPoints)) {
                if (weekData && typeof weekData.totalPoints === 'number') {
                    seasonTotal += weekData.totalPoints;
                    seasonGamesWon += weekData.gamesWon || 0;
                    weeksPlayed++;
                }
            }

            scoringData.totalPoints = seasonTotal;
            scoringData.seasonStats = {
                gamesWon: seasonGamesWon,
                totalGames: weeksPlayed * 16,
                weeksPlayed: weeksPlayed,
                lastUpdated: new Date().toISOString()
            };

            scoringData.lastRecalculation = new Date().toISOString();

            await firebase.firestore().doc(scoringPath).set(scoringData);
        }

        async function runFullPipeline() {
            if (selectedWeeks.size === 0) {
                logToConsole('NO WEEKS SELECTED - SELECT WEEKS FIRST', 'error');
                return;
            }

            logToConsole('RUNNING FULL WU-TANG PIPELINE...', 'info');
            logToConsole('STEP 1: POPULATING RESULTS...', 'info');
            await populateResults();

            logToConsole('STEP 2: RECALCULATING SCORING...', 'info');
            await recalculateScoring();

            logToConsole('STEP 3: VERIFYING SYSTEM...', 'info');
            await checkSystemStatus();

            logToConsole('FULL PIPELINE COMPLETE - WU-TANG FOREVER!', 'success');
        }

        // Emergency Functions
        async function cleanGameDetails() {
            logToConsole('CLEANING GAME DETAILS FROM SCORING DOCUMENTS...', 'info');
            try {
                await autoLogin();

                const usersSnapshot = await firebase.firestore()
                    .collection('artifacts/nerdfootball/pools/nerduniverse-2025/scoring-users')
                    .get();

                let cleanedCount = 0;

                for (const userDoc of usersSnapshot.docs) {
                    const userData = userDoc.data();
                    let needsUpdate = false;
                    const cleanedData = { ...userData };

                    if (cleanedData.weeklyPoints) {
                        for (const [week, weekData] of Object.entries(cleanedData.weeklyPoints)) {
                            if (weekData.gameDetails) {
                                delete weekData.gameDetails;
                                needsUpdate = true;
                            }
                        }
                    }

                    if (needsUpdate) {
                        cleanedData.gameDetailsRemoved = true;
                        cleanedData.cleanupTimestamp = new Date().toISOString();

                        await firebase.firestore().doc(`artifacts/nerdfootball/pools/nerduniverse-2025/scoring-users/${userDoc.id}`).set(cleanedData);
                        cleanedCount++;
                    }
                }

                logToConsole(`CLEANED ${cleanedCount} USER DOCUMENTS`, 'success');

            } catch (error) {
                logToConsole(`CLEANUP ERROR: ${error.message}`, 'error');
            }
        }

        async function backupUserData() {
            logToConsole('BACKING UP USER DATA...', 'info');
            // Implementation would create backup of critical user data
            logToConsole('BACKUP FEATURE COMING SOON', 'info');
        }

        async function emergencyReset() {
            const confirmed = confirm('‚ö†Ô∏è EMERGENCY RESET WILL DELETE ALL SCORING DATA! Are you absolutely sure?');
            if (!confirmed) {
                logToConsole('EMERGENCY RESET CANCELLED', 'info');
                return;
            }

            logToConsole('EMERGENCY RESET NOT IMPLEMENTED - SAFETY FEATURE', 'error');
            logToConsole('Use individual tools to fix specific issues', 'info');
        }

        // Verification Functions
        async function verifyGameWinners() {
            logToConsole('VERIFYING GAME WINNERS...', 'info');
            try {
                await autoLogin();

                for (let week of selectedWeeks.size > 0 ? selectedWeeks : [1, 2, 3]) {
                    const results = await getGameResults(week);
                    const totalGames = Object.keys(results).length;
                    const gamesWithWinners = Object.values(results).filter(game => game.winner).length;

                    if (gamesWithWinners === totalGames && totalGames > 0) {
                        logToConsole(`WEEK ${week}: ‚úÖ ALL ${totalGames} GAMES HAVE WINNERS`, 'success');
                    } else {
                        logToConsole(`WEEK ${week}: ‚ùå ${gamesWithWinners}/${totalGames} GAMES HAVE WINNERS`, 'error');
                    }
                }
            } catch (error) {
                logToConsole(`VERIFICATION ERROR: ${error.message}`, 'error');
            }
        }

        async function verifyUserScoring() {
            logToConsole('VERIFYING USER SCORING...', 'info');
            await showTonyScoring(); // Use Tony as test case
        }

        async function generateSystemReport() {
            logToConsole('GENERATING SYSTEM REPORT...', 'info');
            await checkSystemStatus();
            await verifyGameWinners();
            await showTonyScoring();
            logToConsole('SYSTEM REPORT COMPLETE', 'success');
        }

        // Initialize
        window.addEventListener('load', async () => {
            try {
                await autoLogin();
                logToConsole('WU-TANG ADMIN DASHBOARD LOADED - KILLER BEES ACTIVATED', 'success');
                // Auto-select current weeks
                selectedWeeks = new Set([1, 2, 3]);
                document.querySelectorAll('.week-btn').forEach((btn, idx) => {
                    if (idx < 3) btn.classList.add('selected');
                });
                updateSelectedWeeksDisplay();
            } catch (error) {
                logToConsole(`INITIALIZATION ERROR: ${error.message}`, 'error');
            }
        });
    </script>
</body>
</html>