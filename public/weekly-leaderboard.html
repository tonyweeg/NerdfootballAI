<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎮 Weekly Leaderboard - NerdFootball</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- NFL 2025 Season Week Calendar (Bible-based) -->
    <script>
        window.NFL_2025_WEEKS = {
            1: { start: '2025-09-04', games: '2025-09-04' },
            2: { start: '2025-09-08', games: '2025-09-11' },
            3: { start: '2025-09-15', games: '2025-09-21' },
            4: { start: '2025-09-22', games: '2025-09-26' },
            5: { start: '2025-09-29', games: '2025-10-03' },
            6: { start: '2025-10-06', games: '2025-10-10' },
            7: { start: '2025-10-13', games: '2025-10-17' },
            8: { start: '2025-10-20', games: '2025-10-24' },
            9: { start: '2025-10-27', games: '2025-10-31' },
            10: { start: '2025-11-03', games: '2025-11-07' },
            11: { start: '2025-11-10', games: '2025-11-14' },
            12: { start: '2025-11-17', games: '2025-11-21' },
            13: { start: '2025-11-24', games: '2025-11-28' },
            14: { start: '2025-12-01', games: '2025-12-05' },
            15: { start: '2025-12-08', games: '2025-12-12' },
            16: { start: '2025-12-15', games: '2025-12-19' },
            17: { start: '2025-12-22', games: '2025-12-26' },
            18: { start: '2025-12-29', games: '2026-01-02' }
        };

        // Bible-based current week detection
        window.getCurrentNFLWeek = function() {
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0]; // YYYY-MM-DD format

            // Find current week based on today's date
            for (let week = 1; week <= 18; week++) {
                const weekData = window.NFL_2025_WEEKS[week];
                const weekStart = new Date(weekData.start);
                const nextWeek = window.NFL_2025_WEEKS[week + 1];
                const weekEnd = nextWeek ? new Date(nextWeek.start) : new Date('2026-01-10');

                if (today >= weekStart && today < weekEnd) {
                    return week;
                }
            }

            // Fallback - if we're before week 1, return 1; if after week 18, return 18
            if (todayStr < '2025-09-04') return 1;
            return 18;
        };

        // Get the most recent week with actual game data for leaderboard display
        window.getMostRecentWeekWithData = function() {
            const currentWeek = window.getCurrentNFLWeek();
            const today = new Date();

            // Check if current week has games that have started
            const currentWeekData = window.NFL_2025_WEEKS[currentWeek];
            if (currentWeekData) {
                const gamesDate = new Date(currentWeekData.games);
                // If games have started for current week, show current week
                if (today >= gamesDate) {
                    return currentWeek;
                }
            }

            // Otherwise, show the most recent completed week
            return Math.max(1, currentWeek - 1);
        };
    </script>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* Dark Psychedelic game console styling */
        .game-console {
            background: linear-gradient(135deg, #000000 0%, #1a0033 50%, #000000 100%);
            border: 2px solid;
            border-image: linear-gradient(45deg, #ff0080, #0080ff, #8000ff, #ff0080) 1;
            box-shadow:
                0 0 30px rgba(255, 0, 128, 0.4),
                0 0 60px rgba(0, 128, 255, 0.2),
                inset 0 0 40px rgba(128, 0, 255, 0.1);
        }

        .game-button {
            background: linear-gradient(145deg, #000000 0%, #1a0033 100%);
            border: 2px solid;
            border-image: linear-gradient(45deg, #ff0080, #0080ff, #8000ff, #ff0080) 1;
            color: #ffffff;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow:
                0 0 20px rgba(255, 0, 128, 0.3),
                0 0 40px rgba(0, 128, 255, 0.2);
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
        }

        .game-button:hover {
            background: linear-gradient(145deg, #1a0033 0%, #330066 100%);
            color: #ffffff;
            box-shadow:
                0 0 30px rgba(255, 0, 128, 0.6),
                0 0 60px rgba(0, 128, 255, 0.4);
            transform: translateY(-2px);
            text-shadow:
                0 0 20px rgba(255, 255, 255, 1),
                0 0 40px rgba(255, 0, 128, 0.6);
        }

        .game-button:active {
            transform: translateY(0);
            box-shadow:
                0 0 15px rgba(255, 0, 128, 0.4),
                0 0 30px rgba(0, 128, 255, 0.2);
        }

        .game-button:disabled {
            background: linear-gradient(145deg, #333333 0%, #1a1a1a 100%);
            border-image: linear-gradient(45deg, #666666, #444444, #666666, #444444) 1;
            color: #666666;
            cursor: not-allowed;
            opacity: 0.5;
            transform: none;
            box-shadow: none;
            text-shadow: none;
        }

        /* 🔥 WU-TANG HARDCORE STYLING 🔥 */
        .wu-tang-panel {
            background: linear-gradient(145deg, #0a0a0a 0%, #1a1a1a 50%, #000 100%);
            border: 3px solid #ffd700;
            border-radius: 0;
            box-shadow:
                0 0 20px rgba(255, 215, 0, 0.5),
                inset 0 0 30px rgba(0, 0, 0, 0.8);
            position: relative;
        }

        .wu-tang-panel::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ffd700, #fff, #ffd700, #fff);
            border-radius: 0;
            z-index: -1;
        }

        .wu-tang-stat {
            background: linear-gradient(135deg, #000 0%, #1a1a1a 100%);
            border: 2px solid #ffd700;
            padding: 12px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .wu-tang-stat::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            transition: left 0.5s;
        }

        .wu-tang-stat:hover::after {
            left: 100%;
        }

        .wu-tang-label {
            color: #ffd700;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 10px;
            letter-spacing: 2px;
            text-transform: uppercase;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }

        .wu-tang-value {
            color: #fff;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 18px;
            letter-spacing: 1px;
            text-transform: uppercase;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
            margin: 4px 0;
        }

        .wu-tang-sublabel {
            color: #ccc;
            font-family: 'Courier New', monospace;
            font-size: 8px;
            letter-spacing: 1px;
            text-transform: uppercase;
            opacity: 0.8;
        }

        .wu-tang-mini-stat {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #333;
            padding: 4px 8px;
            border-radius: 0;
        }

        .wu-tang-mini-label {
            color: #999;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .wu-tang-mini-value {
            color: #ffd700;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.6);
        }

        /* Week display HUD style */
        .week-hud {
            background: radial-gradient(circle, #00ff41 0%, #00cc33 100%);
            color: #000;
            border: 3px solid #fff;
            box-shadow:
                0 0 20px rgba(0, 255, 65, 0.6),
                inset 0 0 20px rgba(255, 255, 255, 0.2);
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* Power-up indicators for live games */
        .power-up {
            animation: powerUpPulse 1.5s ease-in-out infinite;
        }

        @keyframes powerUpPulse {
            0%, 100% {
                box-shadow: 0 0 15px rgba(255, 0, 255, 0.6);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 30px rgba(255, 0, 255, 1);
                transform: scale(1.05);
            }
        }

        /* Game-style transitions */
        .slide-transition {
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* Nintendo controller D-pad styling */

        /* Live game indicator */
        .live-indicator {
            animation: liveGlow 2s ease-in-out infinite;
            background: linear-gradient(45deg, #ff0066, #ff3366, #ff0066);
        }

        @keyframes liveGlow {
            0%, 100% {
                box-shadow: 0 0 10px rgba(255, 0, 102, 0.8);
            }
            50% {
                box-shadow: 0 0 20px rgba(255, 0, 102, 1);
            }
        }

        /* Dark Psychedelic terminal theme */
        .terminal-bg {
            background: radial-gradient(circle at 20% 50%, #1a0033 0%, #000000 50%, #0d001a 100%);
        }
        .terminal-text {
            color: #ffffff;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
        }
        .terminal-accent {
            color: #ff0080;
            text-shadow: 0 0 15px rgba(255, 0, 128, 0.6);
        }
        .terminal-secondary {
            color: #0080ff;
            text-shadow: 0 0 15px rgba(0, 128, 255, 0.6);
        }
        .terminal-muted {
            color: #8000ff;
            text-shadow: 0 0 10px rgba(128, 0, 255, 0.4);
        }
        .terminal-surface {
            background: linear-gradient(135deg, rgba(255, 0, 128, 0.1) 0%, rgba(0, 128, 255, 0.1) 100%);
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: radial-gradient(circle at 20% 50%, #1a0033 0%, #000000 50%, #0d001a 100%);
            background-attachment: fixed;
            min-height: 100vh;
        }

        /* Loading animation */
        .loading-dots::after {
            content: '';
            animation: dots 2s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        /* Starry Background Animation */
        @keyframes stars {
            0% { transform: translateY(0); }
            100% { transform: translateY(-2000px); }
        }

        .star-field {
            position: fixed;
            width: 100%;
            height: 200%;
            top: 0;
            left: 0;
            z-index: -1;
            pointer-events: none;
            background:
                radial-gradient(2px 2px at 20% 30%, white, transparent),
                radial-gradient(2px 2px at 60% 70%, white, transparent),
                radial-gradient(1px 1px at 50% 50%, white, transparent),
                radial-gradient(1px 1px at 80% 10%, white, transparent),
                radial-gradient(2px 2px at 90% 60%, white, transparent);
            background-size: 200px 200px, 300px 300px, 150px 150px, 250px 250px, 180px 180px;
            animation: stars 60s linear infinite;
        }

        /* Basic CSS to replace disabled Tailwind */
        .container { max-width: 1200px; margin: 0 auto; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .flex { display: flex; }
        .justify-between { justify-content: space-between; }
        .items-center { align-items: center; }
        .space-x-4 > * + * { margin-left: 1rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-sm { font-size: 0.875rem; }
        .font-bold { font-weight: 700; }
        .border-b-2 { border-bottom-width: 2px; }
        .min-h-screen { min-height: 100vh; }
        .hidden { display: none; }
        .text-center { text-align: center; }
        .rounded-lg { border-radius: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mt-8 { margin-top: 2rem; }
        .p-6 { padding: 1.5rem; }

        /* HEADER NON-STICKY OVERRIDE */
        header {
            position: static !important;
            display: block !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            z-index: 1 !important;
        }

        /* LEADERBOARD READABILITY - INHERITS FROM CONTAINER */
        #full-leaderboard table {
            font-size: 1.1em; /* 10% bigger font */
            width: 100%;
        }

        #full-leaderboard th {
            font-size: 1.15em; /* Headers slightly larger */
            padding: 1rem 0.75rem;
        }

        #full-leaderboard td {
            padding: 1rem 0.75rem;
            font-size: 1.1em;
        }

        /* KILLER BEES WU-TANG BUTTON STYLING */
        .wu-tang-killer-bee-button {
            background: linear-gradient(145deg, #000000 0%, #1a1a1a 50%, #000000 100%);
            border: 3px solid #ffd700;
            color: #ffd700;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow:
                0 0 15px rgba(255, 215, 0, 0.4),
                0 8px 16px rgba(0, 0, 0, 0.8);
            position: relative;
            overflow: hidden;
            border-radius: 0;
        }

        .wu-tang-killer-bee-button::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ffd700, #fff, #ffd700, #fff);
            border-radius: 0;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .wu-tang-killer-bee-button:hover {
            background: linear-gradient(145deg, #1a1a1a 0%, #333333 50%, #1a1a1a 100%);
            color: #ffffff;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
            box-shadow:
                0 0 25px rgba(255, 215, 0, 0.8),
                0 12px 24px rgba(0, 0, 0, 1);
            transform: translateY(-3px);
        }

        .wu-tang-killer-bee-button:hover::before {
            opacity: 0.3;
        }

        .wu-tang-killer-bee-button:active {
            transform: translateY(-1px);
            box-shadow:
                0 0 20px rgba(255, 215, 0, 0.6),
                0 6px 12px rgba(0, 0, 0, 0.8);
        }

        /* SINGLE ROW WU-TANG STATS INLINE STYLING */
        .wu-tang-stat-inline {
            background: linear-gradient(135deg, #000 0%, #1a1a1a 100%);
            border: 2px solid #ffd700;
            padding: 8px 12px;
            position: relative;
            overflow: hidden;
            min-width: 90px;
            flex: 0 0 auto;
        }

        .wu-tang-stat-inline::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            transition: left 0.5s;
        }

        .wu-tang-stat-inline:hover::after {
            left: 100%;
        }

        /* WEEKLY SHAOLIN LEADERS - Podium Styling */
        .rank-gold {
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        .rank-silver {
            color: #c0c0c0;
            text-shadow: 0 0 10px rgba(192, 192, 192, 0.5);
        }
        .rank-bronze {
            color: #cd7f32;
            text-shadow: 0 0 10px rgba(205, 127, 50, 0.5);
        }

        .glow-text {
            text-shadow: 0 0 20px currentColor;
        }

        /* Dark Psychedelic Dashboard Wrapper */
        .modern-dashboard-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            background: radial-gradient(circle at 20% 50%, #1a0033 0%, #000000 50%, #0d001a 100%);
            border-radius: 1rem;
        }

        .modern-leaders-section {
            background: linear-gradient(145deg, #000000 0%, #1a0033 50%, #000000 100%);
            border: 2px solid;
            border-image: linear-gradient(45deg, #ff0080, #0080ff, #8000ff, #ff0080) 1;
            box-shadow:
                0 0 40px rgba(255, 0, 128, 0.3),
                0 0 80px rgba(0, 128, 255, 0.2),
                inset 0 0 40px rgba(128, 0, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .modern-leaders-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 0, 128, 0.2),
                rgba(0, 128, 255, 0.2),
                rgba(128, 0, 255, 0.2),
                transparent);
            animation: psychedelicShimmer 3s ease-in-out infinite;
        }

        @keyframes psychedelicShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .modern-leaders-header {
            background: linear-gradient(135deg, #ff0080 0%, #0080ff 50%, #8000ff 100%);
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
            padding: 1.5rem;
            margin: -1.5rem -1.5rem 1.5rem -1.5rem;
            text-align: center;
            position: relative;
        }

        .modern-insights {
            font-family: 'Courier New', monospace;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .modern-leaders-title {
            font-family: 'Courier New', monospace;
            color: #ffffff;
            font-size: 2rem;
            font-weight: 900;
            text-shadow:
                0 0 20px rgba(255, 255, 255, 1),
                0 0 40px rgba(255, 0, 128, 0.6),
                0 0 60px rgba(0, 128, 255, 0.4);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .modern-podium-container {
            display: flex;
            justify-content: center;
            align-items: end;
            gap: 1rem;
            padding: 2rem 1rem;
            position: relative;
        }

        .weekly-podium-card {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            border: 2px solid #ffffff;
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-width: 200px;
            max-width: 220px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1);
        }

        .weekly-podium-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 0, 128, 0.3),
                rgba(0, 128, 255, 0.3),
                rgba(128, 0, 255, 0.3),
                transparent);
            transition: left 0.5s ease;
        }

        .weekly-podium-card:hover::after {
            left: 100%;
        }

        .weekly-podium-card:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 15px 40px rgba(255, 0, 128, 0.4);
        }

        .weekly-podium-card.first {
            order: 2;
            height: 220px;
            border-color: #ff0080;
            box-shadow:
                0 0 30px rgba(255, 0, 128, 0.6),
                0 0 60px rgba(255, 0, 128, 0.3);
            background: linear-gradient(135deg, #1a0011 0%, #330022 100%);
        }

        .weekly-podium-card.second {
            order: 1;
            height: 180px;
            border-color: #0080ff;
            box-shadow:
                0 0 20px rgba(0, 128, 255, 0.6),
                0 0 40px rgba(0, 128, 255, 0.3);
            background: linear-gradient(135deg, #001122 0%, #002244 100%);
        }

        .weekly-podium-card.third {
            order: 3;
            height: 140px;
            border-color: #8000ff;
            box-shadow:
                0 0 20px rgba(128, 0, 255, 0.6),
                0 0 40px rgba(128, 0, 255, 0.3);
            background: linear-gradient(135deg, #110022 0%, #220044 100%);
        }

        .podium-rank {
            font-size: 2rem;
            margin-bottom: 0.25rem;
        }

        .podium-position {
            font-family: 'Courier New', monospace;
            color: #ffffff;
            font-size: 0.9rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.25rem;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }

        .podium-name {
            font-family: 'Courier New', monospace;
            color: #ffffff;
            font-size: 0.9rem;
            font-weight: 900;
            margin-bottom: 0.5rem;
            text-shadow:
                0 0 15px rgba(255, 255, 255, 0.8),
                0 0 30px rgba(255, 255, 255, 0.4);
            text-transform: uppercase;
            word-break: break-all;
            overflow-wrap: break-word;
        }

        .podium-points {
            font-family: 'Courier New', monospace;
            color: #ffffff;
            font-size: 1.4rem;
            font-weight: 900;
            margin-bottom: 0.25rem;
            text-shadow:
                0 0 15px rgba(255, 255, 255, 1),
                0 0 30px rgba(255, 0, 128, 0.6),
                0 0 45px rgba(0, 128, 255, 0.4);
        }

        .podium-stats {
            font-family: 'Courier New', monospace;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.7rem;
            line-height: 1.2;
            font-weight: bold;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

        /* Mobile responsive podium adjustments */
        @media (max-width: 768px) {
            .podium-rank {
                font-size: 1.5rem;
            }

            .podium-position {
                font-size: 0.75rem;
            }

            .podium-name {
                font-size: 0.75rem;
            }

            .podium-points {
                font-size: 1.1rem;
            }

            .podium-stats {
                font-size: 0.6rem;
            }
        }

        /* Compact Wu-Tang Stats Flow */
        .wu-tang-stats-flow {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1rem;
            padding: 1rem 0;
        }

        .wu-tang-stat-compact {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-width: 100px;
        }

        .modern-leaderboard-section {
            background: linear-gradient(145deg, #000000 0%, #1a0033 100%);
            border-radius: 1rem;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .wu-tang-panel {
            background: linear-gradient(145deg, #000000 0%, #1a1a1a 100%);
            border-radius: 1rem;
        }

        .wu-tang-separator {
            color: #ffffff;
            font-size: 1.8rem;
            font-weight: 900;
            opacity: 0.8;
            text-shadow:
                0 0 10px rgba(255, 255, 255, 0.8),
                0 0 20px rgba(255, 0, 128, 0.4);
        }

        .stat-label {
            font-family: 'Courier New', monospace;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.8rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.25rem;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .stat-value {
            font-family: 'Courier New', monospace;
            color: #ffffff;
            font-size: 1.8rem;
            font-weight: 900;
            text-shadow:
                0 0 20px rgba(255, 255, 255, 1),
                0 0 40px rgba(255, 0, 128, 0.6),
                0 0 60px rgba(0, 128, 255, 0.4);
            margin-bottom: 0.25rem;
        }

        .stat-detail {
            font-family: 'Courier New', monospace;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.7rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

        .wu-tang-detail-flow {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem;
            padding: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        .detail-stat {
            font-family: 'Courier New', monospace;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        .detail-value {
            color: #ffffff;
            margin-left: 0.5rem;
            text-shadow:
                0 0 15px rgba(255, 255, 255, 0.8),
                0 0 30px rgba(255, 0, 128, 0.4);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .wu-tang-stats-flow {
                gap: 1rem;
            }

            .wu-tang-separator {
                display: none;
            }

            .wu-tang-detail-flow {
                gap: 1rem;
            }

            .detail-stat {
                font-size: 0.7rem;
            }
        }

        /* Terminal Header - Full Width Like Grid */
        .terminal-header {
            background: #1a1a1a;
            color: #00ff41;
            font-family: 'JetBrains Mono', monospace;
            padding: 8px;
            margin-bottom: 8px;
            border: none;
        }

        .back-link {
            color: #00ff41;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .back-link:hover {
            color: #ffffff;
        }

        .nav-button {
            background: #111111;
            border: 1px solid #333333;
            color: #00ff41;
            padding: 8px 12px;
            font-family: 'JetBrains Mono', monospace;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-button:hover {
            background: #333333;
            color: #ffffff;
        }

        .nav-button:disabled {
            background: #222222;
            color: #666666;
            cursor: not-allowed;
        }

        .text-gold-400 {
            color: #ffd700;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            font-size: 14px;
        }

        .stat-box {
            background: #111111;
            border: 1px solid #333333;
            padding: 6px 12px;
            text-align: center;
        }

        .stat-value {
            color: #ffd700;
            font-weight: 700;
            font-size: 18px;
        }

        .stat-label {
            color: #888888;
            font-size: 12px;
            text-transform: uppercase;
        }

        /* Mobile responsive adjustments */
        @media (max-width: 768px) {
            .wu-tang-stat-inline {
                min-width: 80px;
                padding: 6px 8px;
            }

            .wu-tang-label {
                font-size: 8px !important;
            }

            .wu-tang-value {
                font-size: 14px !important;
            }

            .wu-tang-sublabel {
                font-size: 6px !important;
            }

            .wu-tang-mini-label {
                font-size: 7px !important;
            }

            .wu-tang-mini-value {
                font-size: 12px !important;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 8px;
            }

            .stat-box {
                padding: 4px 8px;
            }

            .stat-value {
                font-size: 16px;
            }

            .stat-label {
                font-size: 10px;
            }
        }

        /* Dark Psychedelic accuracy color classes */
        .psychedelic-excellent {
            color: #0080ff;
            text-shadow: 0 0 15px rgba(0, 128, 255, 0.8);
            font-weight: bold;
        }

        .psychedelic-good {
            color: #8000ff;
            text-shadow: 0 0 15px rgba(128, 0, 255, 0.6);
            font-weight: bold;
        }

        .psychedelic-poor {
            color: #ff0080;
            text-shadow: 0 0 15px rgba(255, 0, 128, 0.6);
            font-weight: bold;
        }
    </style>
</head>

<body class="terminal-bg min-h-screen">
    <!-- Starry Background -->
    <div class="star-field"></div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Loading Screen -->
        <div id="loading-screen" class="game-console rounded-2xl p-8 text-center mb-8">
            <div class="text-4xl terminal-accent mb-4">🎮</div>
            <h2 class="text-xl font-bold mb-4 terminal-text">Loading Game Data<span class="loading-dots"></span></h2>
            <div class="terminal-muted">Initializing Nintendo-style controls...</div>
            <div class="mt-4">
                <div class="inline-block w-8 h-8 border-t-2 border-terminal-accent rounded-full animate-spin"></div>
            </div>
        </div>

        <!-- Terminal Header - Full Width Like Grid -->
        <div id="week-controls" class="hidden">
            <div class="terminal-header">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center space-x-4">
                        <a href="./nerd-universe.html" class="back-link">
                            ← NERD UNIVERSE
                        </a>
                        <div class="text-3xl font-bold text-gold-400">🎮 WEEKLY LEADERBOARD</div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button id="week-down" class="nav-button">◄ PREV</button>
                        <div class="nav-button" id="week-display">WEEK <span id="current-week-display">4</span></div>
                        <button id="week-up" class="nav-button">NEXT ►</button>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold" id="user-display">Loading...</div>
                        <div class="text-lg font-bold" id="auth-status">Authenticating...</div>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-value" id="weekly-participants">0</div>
                        <div class="stat-label">WARRIORS</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="weekly-high-score">0</div>
                        <div class="stat-label">HIGH SCORE</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="user-rank-display">-</div>
                        <div class="stat-label">YOUR RANK</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="pick-efficiency-display">-%</div>
                        <div class="stat-label">ACCURACY</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="intel-margin-display">-</div>
                        <div class="stat-label">INTEL MARGIN</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Unified Dashboard Container -->
        <div id="dashboard-container" class="hidden modern-dashboard-wrapper">
            <!-- Single Unified Section -->
            <div id="leaderboard-container" class="modern-leaderboard-section rounded-2xl p-6">

                <!-- Top 3 Podium -->
                <div id="weekly-podium" class="modern-podium-container mb-8">
                    <!-- Will be populated by JavaScript -->
                </div>

                <!-- Detail Flow -->
                <div id="stats-container" class="wu-tang-panel p-4 mb-6">
                    <div class="wu-tang-detail-flow">
                        <span class="detail-stat">UPSETS: <span id="upset-picks" class="detail-value">?</span></span>
                        <span class="detail-stat">HIGH CONF: <span id="high-conf-hits" class="detail-value">?</span></span>
                        <span class="detail-stat">PERFECT: <span id="perfect-games" class="detail-value">?</span></span>
                        <span class="detail-stat">POOL: <span id="total-pool" class="detail-value">?</span></span>
                        <span class="detail-stat">TOP 10%: <span id="top-ten-percent" class="detail-value">?</span></span>
                    </div>
                </div>

                <!-- Full Leaderboard Table -->
                <div id="full-leaderboard" class="wu-tang-panel p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold terminal-text">📊 FULL RANKINGS</h2>
                        <div id="last-updated" class="text-sm terminal-muted">Last updated: --</div>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-terminal-accent">
                                    <th class="text-left py-3 px-2 terminal-accent font-bold">#</th>
                                    <th class="text-left py-3 px-2 terminal-accent font-bold">Player</th>
                                    <th class="text-center py-3 px-2 terminal-accent font-bold">Points</th>
                                    <th class="text-center py-3 px-2 terminal-accent font-bold">Correct</th>
                                    <th class="text-center py-3 px-2 terminal-accent font-bold">Accuracy</th>
                                    <th class="text-center py-3 px-2 terminal-accent font-bold">Behind</th>
                                </tr>
                            </thead>
                            <tbody id="leaderboard-body">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
        </div>

        <!-- Error Display -->
        <div id="error-container" class="hidden game-console rounded-2xl p-6 text-center">
            <div class="text-4xl terminal-accent mb-4">⚠️</div>
            <h2 class="text-xl font-bold mb-4 terminal-text">Game Error</h2>
            <div id="error-message" class="terminal-muted mb-4">Something went wrong...</div>
            <button class="game-button" onclick="window.location.reload()">
                🔄 RESTART GAME
            </button>
        </div>
    </main>

    <!-- Firebase SDK and Authentication -->
    <script type="module">
        import { getFirebaseConfig } from './js/config/firebase-config.js';
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';

        // Initialize Firebase
        const app = initializeApp(getFirebaseConfig());
        const auth = getAuth(app);
        window.auth = auth;

        // Global variables
        let currentWeek = window.getMostRecentWeekWithData();
        let leaderboardData = null;
        let updateInterval = null;

        // DOM elements
        const loadingScreen = document.getElementById('loading-screen');
        const weekControls = document.getElementById('week-controls');
        const dashboardContainer = document.getElementById('dashboard-container');
        const errorContainer = document.getElementById('error-container');
        const currentWeekDisplay = document.getElementById('current-week-display');
        const userDisplay = document.getElementById('user-display');
        const authStatus = document.getElementById('auth-status');

        // Authentication handling
        async function initializeAuth() {
            return new Promise((resolve) => {
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userDisplay.textContent = `Welcome, ${user.displayName || user.email}`;
                        authStatus.textContent = '✅ Authenticated';
                        resolve(true);
                    } else {
                        userDisplay.textContent = 'Not signed in';
                        authStatus.textContent = '❌ Sign in required';
                        resolve(false);
                    }
                });
            });
        }

        // Nintendo-style week navigation
        function initializeWeekControls() {
            // D-Pad controls
            document.getElementById('week-up').onclick = () => changeWeek(currentWeek + 1);
            document.getElementById('week-down').onclick = () => changeWeek(currentWeek - 1);
        }

        // Change week with Nintendo-style transition (GLOBAL SCOPE)
        window.changeWeek = async function(newWeek) {
            if (newWeek < 1 || newWeek > 18 || newWeek === currentWeek) return;

            currentWeek = newWeek;
            updateWeekDisplay();

            // Add slide transition effect
            dashboardContainer.style.transform = 'translateX(100%)';
            setTimeout(() => {
                loadWeeklyLeaderboard();
                dashboardContainer.style.transform = 'translateX(0)';
            }, 150);
        };

        function updateWeekDisplay() {
            currentWeekDisplay.textContent = currentWeek;

            // Update button states
            document.getElementById('week-up').disabled = currentWeek >= 18;
            document.getElementById('week-down').disabled = currentWeek <= 1;
        }

        // Load weekly leaderboard data
        async function loadWeeklyLeaderboard() {
            try {
                showLoading();
                console.log(`🔥 WEEKLY LEADERBOARD: Loading Week ${currentWeek} leaderboard...`);
                console.log(`📍 Date: ${new Date().toISOString()}`);
                console.log(`📊 Fetching from Cloud Function for Week ${currentWeek}`);

                const cacheBuster = Date.now();
                const response = await fetch(`https://getweeklyleaderboard-np7uealtnq-uc.a.run.app?week=${currentWeek}&t=${cacheBuster}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const result = await response.json();
                console.log('🎮 Response from backend:', result);

                if (result.success) {
                    leaderboardData = result.data;

                    // Check if week has meaningful data (games started or completed)
                    const hasGamesStarted = result.data.gameStates &&
                        (result.data.gameStates.live > 0 || result.data.gameStates.completed > 0);
                    const hasScores = result.data.metadata && result.data.metadata.highScore > 0;

                    if (!hasGamesStarted && !hasScores && result.data.gameStates.upcoming > 0) {
                        // Week hasn't started yet - show helpful message
                        showNoDataMessage(currentWeek, result.data);
                    } else {
                        renderWeeklyLeaderboard(leaderboardData);

                        // Auto-refresh disabled per user request
                        // if (leaderboardData.gameStates.live > 0) {
                        //     startLiveUpdates();
                        // } else {
                        //     stopLiveUpdates();
                        // }
                    }
                } else if (result.regenerating) {
                    // Cache not found - backend is generating fresh data
                    console.log('🔄 Backend is regenerating cache for Week', currentWeek);
                    showNoDataMessage(currentWeek, {
                        gameStates: { upcoming: 1 },
                        metadata: { highScore: 0 }
                    });
                } else {
                    throw new Error(result.error || 'Failed to load leaderboard');
                }

            } catch (error) {
                console.error('❌ Error loading weekly leaderboard:', error);
                showError(`Failed to load Week ${currentWeek} leaderboard: ${error.message}`);
            }
        }

        // Render Nintendo-style leaderboard
        function renderWeeklyLeaderboard(data) {
            // Ensure leaderboard structure is restored if it was replaced by showNoDataMessage
            ensureLeaderboardStructure();

            // 🥋 Render Weekly Shaolin Leaders (Top 3)
            renderWeeklyShaolin(data, currentWeek);

            renderWuTangStats(data, currentWeek, auth.currentUser);
            renderFullLeaderboard(data.standings);

            const lastUpdatedEl = document.getElementById('last-updated');
            if (lastUpdatedEl) {
                lastUpdatedEl.textContent = `Last updated: ${new Date(data.generatedAt).toLocaleTimeString()}`;
            }

            showLeaderboard();
        }

        // 🥋 Render Weekly Shaolin Leaders Podium
        function renderWeeklyShaolin(data, weekNumber) {
            const weeklyPodium = document.getElementById('weekly-podium');
            const topThree = data.standings ? data.standings.slice(0, 3) : [];

            // Update weekly stats
            document.getElementById('weekly-participants').textContent = data.standings?.length || 0;
            document.getElementById('weekly-high-score').textContent = data.metadata?.highScore || 0;
            document.getElementById('current-week-display').textContent = weekNumber;

            // Update additional stats for new header
            const currentUserData = data.standings?.find(u => u.userId === window.auth.currentUser?.uid);
            if (currentUserData) {
                const userRank = data.standings?.findIndex(u => u.userId === window.auth.currentUser?.uid) + 1 || '-';
                const totalUsers = data.standings?.length || 0;
                document.getElementById('user-rank-display').textContent = userRank !== '-' ? `${userRank}/${totalUsers}` : '-';

                const accuracy = currentUserData.totalPicks > 0 ?
                    Math.round((currentUserData.correctPicks / currentUserData.totalPicks) * 100) : 0;
                document.getElementById('pick-efficiency-display').textContent = `${accuracy}%`;

                // Calculate and display intel margin
                const leader = data.standings?.[0];
                const leaderPoints = leader?.totalPoints || 0;
                const userPoints = currentUserData?.totalPoints || 0;
                const margin = leaderPoints - userPoints;
                document.getElementById('intel-margin-display').textContent = margin === 0 ? 'LEADER' : `-${margin}`;
            } else {
                document.getElementById('user-rank-display').textContent = '-';
                document.getElementById('pick-efficiency-display').textContent = '-%';
                document.getElementById('intel-margin-display').textContent = '-';
            }

            // Render top 3 podium
            weeklyPodium.innerHTML = '';

            topThree.forEach((player, index) => {
                const position = index + 1;
                let icon = '';
                let cardClass = '';
                let positionText = '';

                switch (position) {
                    case 1:
                        icon = '🥇';
                        cardClass = 'first';
                        positionText = '#1';
                        break;
                    case 2:
                        icon = '🥈';
                        cardClass = 'second';
                        positionText = '#2';
                        break;
                    case 3:
                        icon = '🥉';
                        cardClass = 'third';
                        positionText = '#3';
                        break;
                }

                const accuracyPercent = player.totalPicks > 0 ?
                    ((player.correctPicks / player.totalPicks) * 100).toFixed(1) : '0.0';

                weeklyPodium.innerHTML += `
                    <div class="weekly-podium-card ${cardClass}">
                        <div class="podium-rank">${icon}</div>
                        <div class="podium-position">${positionText}</div>
                        <div class="podium-name">${player.name.split('@')[0]}</div>
                        <div class="podium-points">${player.totalPoints} pts</div>
                        <div class="podium-stats">
                            ${player.correctPicks}/${player.totalPicks} correct<br>
                            ${accuracyPercent}% accuracy
                            ${!player.hasPicks ? '<br><span style="color: #e74c3c;">No picks submitted</span>' : ''}
                        </div>
                    </div>
                `;
            });

            // The podium is now always visible within the unified container
        }

        // Ensure the original leaderboard HTML structure exists
        function ensureLeaderboardStructure() {
            const weeklyPodium = document.getElementById('weekly-podium');
            const statsContainer = document.getElementById('stats-container');
            const fullLeaderboard = document.getElementById('full-leaderboard');

            if (!weeklyPodium || !statsContainer || !fullLeaderboard) {
                console.log('🔧 Restoring leaderboard HTML structure...');
                document.getElementById('leaderboard-container').innerHTML = `
                    <!-- Top 3 Podium -->
                    <div id="weekly-podium" class="modern-podium-container mb-8">
                        <!-- Will be populated by JavaScript -->
                    </div>

                    <!-- Detail Flow -->
                    <div id="stats-container" class="wu-tang-panel p-4 mb-6">
                        <div class="wu-tang-detail-flow">
                            <span class="detail-stat">UPSETS: <span id="upset-picks" class="detail-value">?</span></span>
                            <span class="detail-stat">HIGH CONF: <span id="high-conf-hits" class="detail-value">?</span></span>
                            <span class="detail-stat">PERFECT: <span id="perfect-games" class="detail-value">?</span></span>
                            <span class="detail-stat">POOL: <span id="total-pool" class="detail-value">?</span></span>
                            <span class="detail-stat">TOP 10%: <span id="top-ten-percent" class="detail-value">?</span></span>
                        </div>
                    </div>

                    <!-- Full Leaderboard Table -->
                    <div id="full-leaderboard" class="wu-tang-panel p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-bold terminal-text">📊 FULL RANKINGS</h2>
                            <div id="last-updated" class="text-sm terminal-muted">Last updated: --</div>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-terminal-accent">
                                        <th class="text-left py-3 px-2 terminal-accent font-bold">#</th>
                                        <th class="text-left py-3 px-2 terminal-accent font-bold">Player</th>
                                        <th class="text-center py-3 px-2 terminal-accent font-bold">Points</th>
                                        <th class="text-center py-3 px-2 terminal-accent font-bold">Correct</th>
                                        <th class="text-center py-3 px-2 terminal-accent font-bold">Accuracy</th>
                                        <th class="text-center py-3 px-2 terminal-accent font-bold">Behind</th>
                                    </tr>
                                </thead>
                                <tbody id="leaderboard-body">
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            }
        }

        function renderWuTangStats(data, weekNumber, currentUser) {
            // Update main stats with null checks
            const weekChamberEl = document.getElementById('week-chamber');
            if (weekChamberEl) weekChamberEl.textContent = `WEEK ${weekNumber}`;

            // Find current user's rank
            const userRank = data.standings?.findIndex(u => u.userId === currentUser?.uid) + 1 || '?';
            const totalUsers = data.standings?.length || 0;
            const userRankEl = document.getElementById('user-rank');
            if (userRankEl) userRankEl.textContent = userRank !== '?' ? `RANK: ${userRank}/${totalUsers}` : 'RANK: N/A';

            // Calculate nerdy stats
            const allUsers = data.standings || [];
            const currentUserData = allUsers.find(u => u.userId === currentUser?.uid);

            // Precision (hit rate) with null checks
            const precision = currentUserData ?
                Math.round((currentUserData.correctPicks / currentUserData.totalPicks) * 100) : 0;
            const pickEfficiencyEl = document.getElementById('pick-efficiency');
            if (pickEfficiencyEl) pickEfficiencyEl.textContent = `${precision}%`;

            // Average confidence of correct picks with null checks
            let avgConfidence = 0;
            if (currentUserData?.picks) {
                const correctPicks = Object.values(currentUserData.picks)
                    .filter(pick => pick.isCorrect);
                avgConfidence = correctPicks.length > 0 ?
                    Math.round(correctPicks.reduce((sum, pick) => sum + pick.confidence, 0) / correctPicks.length) : 0;
            }
            const avgConfidenceEl = document.getElementById('avg-confidence');
            if (avgConfidenceEl) avgConfidenceEl.textContent = avgConfidence;

            // Leader margin with null checks
            const leader = allUsers[0];
            const leaderPoints = leader?.totalPoints || 0;
            const userPoints = currentUserData?.totalPoints || 0;
            const margin = leaderPoints - userPoints;
            const weeklyIntelEl = document.getElementById('weekly-intel');
            if (weeklyIntelEl) weeklyIntelEl.textContent = margin === 0 ? 'LEADER' : `-${margin}`;

            // Extended nerdy stats
            // Upset picks (games where winner was picked by <40% of users)
            let upsetPicks = 0;
            if (currentUserData?.picks) {
                const totalPicks = allUsers.length;
                Object.entries(currentUserData.picks).forEach(([gameId, userPick]) => {
                    if (userPick.isCorrect) {
                        const samePickers = allUsers.filter(user =>
                            user.picks?.[gameId]?.userPick === userPick.userPick).length;
                        if ((samePickers / totalPicks) < 0.4) upsetPicks++;
                    }
                });
            }
            const upsetPicksEl = document.getElementById('upset-picks');
            if (upsetPicksEl) upsetPicksEl.textContent = upsetPicks;

            // High confidence hits (>12 confidence and correct) with null checks
            const highConfHits = currentUserData?.picks ?
                Object.values(currentUserData.picks).filter(p => p.isCorrect && p.confidence >= 13).length : 0;
            const highConfHitsEl = document.getElementById('high-conf-hits');
            if (highConfHitsEl) highConfHitsEl.textContent = highConfHits;

            // Perfect games (16/16 correct - rare AF) with null checks
            const perfectPlayers = allUsers.filter(u => u.correctPicks === 16).length;
            const perfectGamesEl = document.getElementById('perfect-games');
            if (perfectGamesEl) perfectGamesEl.textContent = perfectPlayers;

            // Total pool size with null checks
            const totalPoolEl = document.getElementById('total-pool');
            if (totalPoolEl) totalPoolEl.textContent = totalUsers;

            // Top 10% threshold with null checks
            const top10Percent = Math.ceil(totalUsers * 0.1);
            const isTop10 = userRank !== '?' && userRank <= top10Percent;
            const topTenPercentEl = document.getElementById('top-ten-percent');
            if (topTenPercentEl) topTenPercentEl.textContent = isTop10 ? 'YES' : 'NO';
        }

        function renderFullLeaderboard(standings) {
            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = '';

            standings.forEach((user, index) => {
                const row = document.createElement('tr');
                row.className = index % 2 === 0 ? 'terminal-surface' : '';

                let rankDisplay = user.rank;
                if (user.rank === 1) rankDisplay = '🥇';
                else if (user.rank === 2) rankDisplay = '🥈';
                else if (user.rank === 3) rankDisplay = '🥉';

                const accuracyColor = user.pickAccuracy >= 60 ? 'psychedelic-excellent' :
                                    user.pickAccuracy >= 40 ? 'psychedelic-good' : 'psychedelic-poor';

                row.innerHTML = `
                    <td class="py-3 px-2 terminal-text font-bold">${rankDisplay}</td>
                    <td class="py-3 px-2">
                        <div class="terminal-text font-semibold">${user.name.split('@')[0]}</div>
                        ${!user.hasPicks ? '<span class="text-xs terminal-muted">No picks</span>' : ''}
                    </td>
                    <td class="text-center py-3 px-2 terminal-accent text-lg font-bold">${user.totalPoints}</td>
                    <td class="text-center py-3 px-2 terminal-secondary">${user.correctPicks}/${user.totalPicks}</td>
                    <td class="text-center py-3 px-2 ${accuracyColor} font-semibold">${user.pickAccuracy.toFixed(1)}%</td>
                    <td class="text-center py-3 px-2 terminal-muted">${user.pointsFromLeader > 0 ? '-' + user.pointsFromLeader : '—'}</td>
                `;

                tbody.appendChild(row);
            });
        }

        function updateGameStats(gameStates, metadata) {
            const weekStatus = document.getElementById('week-status');
            if (gameStates.completed === 16) {
                weekStatus.textContent = 'All games completed';
                weekStatus.className = 'text-xs psychedelic-excellent';
            } else if (gameStates.live > 0) {
                weekStatus.textContent = `${gameStates.live} games live`;
                weekStatus.className = 'text-xs psychedelic-good';
            } else {
                weekStatus.textContent = `${gameStates.completed}/16 completed`;
                weekStatus.className = 'text-xs terminal-muted';
            }

            // Live indicator removed - will add back later
        }

        // Real-time updates for live games
        function startLiveUpdates() {
            if (updateInterval) return;

            console.log('🔴 Starting live updates...');
            updateInterval = setInterval(() => {
                loadWeeklyLeaderboard();
            }, 30000); // Update every 30 seconds during live games
        }

        function stopLiveUpdates() {
            if (updateInterval) {
                console.log('⏹️ Stopping live updates');
                clearInterval(updateInterval);
                updateInterval = null;
            }
        }

        // Utility functions - Use the correct NFL week calculation (same as window.getCurrentNFLWeek)
        function getCurrentWeekNumber() {
            return window.getCurrentNFLWeek();
        }

        function showLoading() {
            loadingScreen.classList.remove('hidden');
            weekControls.classList.add('hidden');
            dashboardContainer.classList.add('hidden');
            errorContainer.classList.add('hidden');
        }

        function showLeaderboard() {
            loadingScreen.classList.add('hidden');
            weekControls.classList.remove('hidden');
            dashboardContainer.classList.remove('hidden');
            errorContainer.classList.add('hidden');
        }

        // Show Wu-Tang styled message for weeks that haven't started
        function showNoDataMessage(weekNumber, data) {
            const previousWeek = weekNumber - 1;
            const gameDate = window.NFL_2025_WEEKS[weekNumber]?.games || 'TBD';
            const gameDateTime = new Date(gameDate).toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            const message = `
                <div class="p-8 text-center" style="background: linear-gradient(135deg, #000000 0%, #1a0033 50%, #000000 100%); border-radius: 1rem;">
                    <div class="text-6xl mb-6">🎮</div>
                    <h2 class="text-3xl font-bold mb-4 terminal-text" style="text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);">
                        CHAMBER SEALED
                    </h2>
                    <p class="text-xl font-bold mb-4 terminal-accent" style="font-size: 1.2em;">WEEK ${weekNumber} AWAITING UNLOCK</p>
                    <p class="terminal-muted mb-6" style="color: #888888;">Games unlock on ${gameDateTime}</p>

                    <div class="mb-8 flex justify-center">
                        <div class="p-6 rounded-lg" style="background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);">
                            <div class="stat-label">PLAYERS READY</div>
                            <div class="stat-value">${data.metadata?.usersWithPicks || 0}/${data.metadata?.totalUsers || 0}</div>
                            <div class="stat-detail">WAITING FOR UNLOCK</div>
                        </div>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-6 justify-center">
                        <button onclick="location.href='./index.html'"
                                class="game-button">
                            🏈 VIEW SEASON LEADERBOARD
                        </button>
                        ${previousWeek >= 1 ?
                            `<button onclick="changeWeek(${previousWeek})"
                                     class="game-button">
                                🔙 WEEK ${previousWeek} RESULTS
                            </button>` : ''}
                        <button onclick="location.href='./index.html'"
                                class="game-button">
                            ⚡ MAKE PICKS
                        </button>
                    </div>
                </div>
            `;

            // Show message in a temporary container to preserve original structure
            const tempContainer = document.createElement('div');
            tempContainer.innerHTML = message;

            // Clear and replace leaderboard container content but preserve structure
            const leaderboardContainer = document.getElementById('leaderboard-container');
            leaderboardContainer.innerHTML = '';
            leaderboardContainer.appendChild(tempContainer.firstElementChild);

            loadingScreen.classList.add('hidden');
            weekControls.classList.remove('hidden');
            dashboardContainer.classList.remove('hidden');
            errorContainer.classList.add('hidden');
        }

        function showError(message) {
            document.getElementById('error-message').textContent = message;
            loadingScreen.classList.add('hidden');
            weekControls.classList.add('hidden');
            dashboardContainer.classList.add('hidden');
            errorContainer.classList.remove('hidden');
        }

        // Initialize everything
        async function initialize() {
            console.log('🎮 Initializing Nintendo-style Weekly Leaderboard...');

            const isAuthenticated = await initializeAuth();
            if (!isAuthenticated) {
                showError('Please sign in to view the leaderboard');
                return;
            }

            initializeWeekControls();
            updateWeekDisplay();

            // Load initial week data
            await loadWeeklyLeaderboard();
        }

        // Start the game!
        initialize();

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            stopLiveUpdates();
        });
    </script>
</body>
</html>